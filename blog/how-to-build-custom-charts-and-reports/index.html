<!DOCTYPE html>
<html>
  <head>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="initial-scale=1">
<link href="https://fonts.googleapis.com/css?family=Julius+Sans+One|Slabo+13px|Open+Sans:300" rel="stylesheet">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
<meta charset="utf-8">
<link rel="stylesheet" href="https://codecreativeio.github.io/assets/main.min.d206194abbd1ce5a0ca819b68f103dc21cb08c4864ac772c71d5e60a0e10d86e.css">
<title>How to Build Custom ServiceNow Charts and Reports (Video) | CodeCreative | A ServiceNow Blog</title>
<meta name="description" content="This video demystifies a fairly advanced scripting technique that I have used to achieve some pretty amazing charts in the past in ServiceNow. Using a UI Page combined with ServiceNow&#39;s built in version of HighCharts produces some great results.">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?d=20181101201248">
<link rel="canonical" href="https://codecreativeio.github.io/blog/how-to-build-custom-charts-and-reports/"><meta property="og:site_name" content="CodeCreative | A ServiceNow Blog">
<meta property="og:title" content="How to Build Custom ServiceNow Charts and Reports (Video)">
<meta property="og:url" content="https://codecreativeio.github.io/blog/how-to-build-custom-charts-and-reports/">

<meta property="og:type" content="article">

<meta property="og:description" content="This video demystifies a fairly advanced scripting technique that I have used to achieve some pretty amazing charts in the past in ServiceNow. Using a UI Page combined with ServiceNow&#39;s built in version of HighCharts produces some great results.">

<meta property="og:image" content="https://codecreativeio.github.io/blog/how-to-build-custom-charts-and-reports/images/social.png">

<meta itemprop="name" content="How to Build Custom ServiceNow Charts and Reports (Video)">
<meta itemprop="url" content="https://codecreativeio.github.io/blog/how-to-build-custom-charts-and-reports/">
<meta itemprop="description" content="This video demystifies a fairly advanced scripting technique that I have used to achieve some pretty amazing charts in the past in ServiceNow. Using a UI Page combined with ServiceNow&#39;s built in version of HighCharts produces some great results.">

<meta itemprop="thumbnailUrl" content="https://codecreativeio.github.io/blog/how-to-build-custom-charts-and-reports/images/social.png">
<link rel="image_src" href="https://codecreativeio.github.io/blog/how-to-build-custom-charts-and-reports/images/social.png">
<meta itemprop="image" content="https://codecreativeio.github.io/blog/how-to-build-custom-charts-and-reports/images/social.png">


<meta name="twitter:title" content="How to Build Custom ServiceNow Charts and Reports (Video)">
<meta name="twitter:image" content="https://codecreativeio.github.io/blog/how-to-build-custom-charts-and-reports/images/social.png">
<meta name="twitter:url" content="https://codecreativeio.github.io/blog/how-to-build-custom-charts-and-reports/">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:description" content="This video demystifies a fairly advanced scripting technique that I have used to achieve some pretty amazing charts in the past in ServiceNow. Using a UI Page combined with ServiceNow&#39;s built in version of HighCharts produces some great results.">

<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-90280965-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-90280965-1');
</script>

<script type="application/ld+json">
{
    "@context" : "http://schema.org",
    "@type" : "BlogPosting",
    "mainEntityOfPage": {
         "@type": "WebPage",
         "@id": "https://codecreativeio.github.io/"
    },
    "name" : "How to Build Custom ServiceNow Charts and Reports (Video)",
    "headline" : "How to Build Custom ServiceNow Charts and Reports (Video)",
    "description" : "This video demystifies a fairly advanced scripting technique that I have used to achieve some pretty amazing charts in the past in ServiceNow. Using a UI Page combined with ServiceNow&#39;s built in version of HighCharts produces some great results.","image": "https://codecreativeio.github.io/blog/how-to-build-custom-charts-and-reports/images/social.png","inLanguage" : "en-US",
      "author" : "Travis Toulson",
      "creator" : "Travis Toulson","publisher": "Travis Toulson",
    "copyrightHolder" : "Travis Toulson",
    "copyrightYear" : "2015",
    "datePublished": "2015-05-04 16:00:00 &#43;0000 UTC",
    "dateModified" : "2015-05-04 16:00:00 &#43;0000 UTC",
    "url" : "https://codecreativeio.github.io/blog/how-to-build-custom-charts-and-reports/",
    "wordCount" : "591",
    "keywords" : [ "Blog" ]
}
</script>


  </head>
  <body><header role="banner">
  <h1 class="logo">
      <a href="/">
         <img src="/assets/codecreativelogo.png" alt="How to Build Custom ServiceNow Charts and Reports (Video)" />
         <span class="sr-only">CodeCreative Logo, click to navigate home</span>
      </a>
    </h1>

  <div class="menuToggle">
    <button class="hamburger" type="button" onclick="toggleMenu()">
      <span class="hamburger-box">
        <span class="hamburger-inner"></span>
      </span>
      <span class="sr-only">Toggle Menu</span>
    </button>
  </div>

  <nav class="fullNav">
    <ul>
      
      
        <li title="Home">
          <a class="" href="/">Home</a>
        </li>
      
        <li title="Blog">
          <a class="" href="/blog/">Blog</a>
        </li>
      
        <li title="About">
          <a class="" href="/about/">About</a>
        </li>
      
        <li title="Contact">
          <a class="" href="/contact/">Contact</a>
        </li>
      
    </ul>
  </nav>
</header>
<main>
  <header class="banner">
    <h1>How to Build Custom ServiceNow Charts and Reports (Video)</h1>
  </header>

  <div class="content text-content">
    <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

      <header class="post-header">
        <h1 class="post-title p-name sr-only" itemprop="name headline">How to Build Custom ServiceNow Charts and Reports (Video)</h1>
        <p class="post-meta">
            <time class="dt-published" datetime="2015-05-04T16:00:00Z" itemprop="datePublished">
            May 04, 2015
            </time>
          
            
            â€¢ <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Travis Toulson</span></span>
          
        </p>
      </header>

      <div class="post-content e-content" itemprop="articleBody">
        <div class="videoWrapper">
  <iframe src="//www.youtube.com/embed/fOQwpFkcTZs?wmode=opaque&amp;enablejsapi=1" height="480" width="640" scrolling="no" frameborder="0" allowfullscreen="">
  </iframe>
</div>

<p>The ServiceNow Community can be a tough place to communicate without winding up with a wall of intimidating technical text. Add to that the gaps in technical knowledge and understanding as well as differences in jargon and we often end up with walls of text and frequent churn in the comments in order to arrive at a solution. Thankfully, the Community offers some great rich media features like videos! With that in mind, I am very excited to kick off the a new webcast series called Code Creative! With Code Creative, I will have the opportunity to answer questions by demonstrating techniques rather than just explaining them.</p>

<p>I have been kicking around the idea of starting a webcast series dedicated to answering Community questions for a while and found the perfect opportunity with a question from <a href="https://community.servicenow.com/people/VAIGAI.KOTHANDARAMAN">vaigai.kothandaraman.</a> In Episode 1, Vaigai wants to know how to create custom reports when the native reporting engine is unable to provide the right look and feel and I demonstrate a technique using HighCharts and a UI Page to wield absolute control over the data and the final report. This video demystifies a fairly advanced scripting technique that I have used to achieve some pretty amazing charts in the past and by the end I am sure the community will come up with some even more amazing ones!</p>

<p>I hope you enjoy the video and I look forward to answering your questions in future episodes!</p>

<p>Original Question: <a href="https://community.servicenow.com/thread/181930">Custom Chart Scripts</a></p>

<p>Additional Charting Resources:</p>

<ul>
<li><a href="https://community.servicenow.com/external-link.jspa?url=http%3A%2F%2Fwiki.servicenow.com%2Findex.php%3Ftitle%3DUsing_UI_Pages_as_Gauges%23gsc.tab%3D0">Using UI Pages as Gauges - ServiceNow Wiki</a></li>
<li><a href="https://community.servicenow.com/external-link.jspa?url=http%3A%2F%2Fwww.highcharts.com%2F">http://www.highcharts.com/</a></li>
</ul>

<p>Another Option for Custom Charts using the Legacy JFreeChart</p>

<ul>
<li><a href="https://community.servicenow.com/external-link.jspa?url=http%3A%2F%2Fwiki.servicenow.com%2Findex.php%3Ftitle%3DCustom_Charts_Plugin%23gsc.tab%3D0">Custom Chart Actions - ServiceNow Wiki</a></li>
<li><a href="https://community.servicenow.com/external-link.jspa?url=http%3A%2F%2Fwiki.servicenow.com%2Findex.php%3Ftitle%3DCustom_Chart_Definitions%23gsc.tab%3D0">Custom Chart Definitions - ServiceNow Wiki</a></li>
<li><a href="https://community.servicenow.com/external-link.jspa?url=http%3A%2F%2Fwiki.servicenow.com%2Findex.php%3Ftitle%3DCustom_Chart_Rendering%23gsc.tab%3D0">Custom Chart Rendering - ServiceNow Wiki</a></li>
</ul>

<p>Here is the UI Page used in the video:</p>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34; ?&gt;</span>  
<span class="nt">&lt;j:jelly</span> <span class="na">trim=</span><span class="s">&#34;false&#34;</span> <span class="na">xmlns:j=</span><span class="s">&#34;jelly:core&#34;</span> <span class="na">xmlns:g=</span><span class="s">&#34;glide&#34;</span> <span class="na">xmlns:j2=</span><span class="s">&#34;null&#34;</span> <span class="na">xmlns:g2=</span><span class="s">&#34;null&#34;</span><span class="nt">&gt;</span>  
    <span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src=</span><span class="s">&#34;/scripts/GlideV2ChartingIncludes.jsx?v=10-19-2014_0741&#34;</span><span class="nt">&gt;&lt;/script&gt;</span>  
    <span class="nt">&lt;g2:evaluate&gt;</span>  
        var openQuery = &#39;stateIN1,2,3,4,5&#39;,  
            resolvedQuery = &#39;state=6^resolved_atONToday@javascript:gs.daysAgoStart(0)@javascript:gs.daysAgoEnd(0)&#39;,  
            closedQuery = &#39;state=7^closed_atONToday@javascript:gs.daysAgoStart(0)@javascript:gs.daysAgoEnd(0)&#39;,  
            allQuery = &#39;stateIN1,2,3,4,5^NQstate=6^resolved_atONToday@javascript:gs.daysAgoStart(0)@javascript:gs.daysAgoEnd(0)^NQstate=7^closed_atONToday@javascript:gs.daysAgoStart(0)@javascript:gs.daysAgoEnd(0)&#39;,  
            ga,  
            categories = [],  
            series = [];  


        // Setup Categories  
        var ga = new GlideAggregate(&#39;incident&#39;);  
        ga.addEncodedQuery(allQuery);  
        ga.addAggregate(&#39;COUNT&#39;);  
        ga.groupBy(&#39;location&#39;);  
        ga.orderBy(&#39;location&#39;);  
        ga.query();  
        while (ga.next()) {  
            categories.push(ga.location.getDisplayValue() + &#39;&#39; || &#39;(empty)&#39;);  
        }  


        // Reusable function for building the 3 Series  
        function getSeries(name, index, query, categories) {  
            var ga = new GlideAggregate(&#39;incident&#39;),  
                data = [],  
                i,  
                cat;  


            // Fill data with 0&#39;s  
            for (i = 0; i != categories.length; i++) {  
                data.push(0);  
            }  


            ga.addEncodedQuery(query);  
            ga.addAggregate(&#39;COUNT&#39;);  
            ga.groupBy(&#39;location&#39;);  
            ga.orderBy(&#39;location&#39;);  
            ga.query();  
            while (ga.next()) {  
                // Find category index  
                for (i = 0; i != categories.length; i++) {  
                    cat = ga.location.getDisplayValue() + &#39;&#39; || &#39;(empty)&#39;;  
                    if (categories[i] == cat) {  
                        break;  
                    }  
                }  


                data[i] = ga.getAggregate(&#39;COUNT&#39;) * 1;  
            }  


            return { &#39;name&#39;: name, &#39;legendIndex&#39;: index, &#39;data&#39;: data };  
        }  


        // Add the 3 series to an array for output  
        series.push(getSeries(&#39;Open&#39;, 0, openQuery, categories));  // Add Open Series  
        series.push(getSeries(&#39;Resolved&#39;, 1, resolvedQuery, categories)); // Add Resolved Series  
        series.push(closedSeries = getSeries(&#39;Closed&#39;, 1, closedQuery, categories)); // Add Closed Series  


        // JSON encode the series and categories.  The JSON strings will be embedded with a JEXL expression into the client side code  
        series = new JSON().encode(series);  
        categories = new JSON().encode(categories);  
    <span class="nt">&lt;/g2:evaluate&gt;</span>  
    <span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">&#34;wide&#34;</span><span class="nt">&gt;&lt;tr&gt;&lt;td</span> <span class="na">align=</span><span class="s">&#34;center&#34;</span><span class="nt">&gt;</span>  
        <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&#34;custom_report&#34;</span> <span class="na">class=</span><span class="s">&#34;highcharts-container&#34;</span> <span class="na">style=</span><span class="s">&#34;position: static; overflow: hidden; width: 650px; height: 450px; text-align: left; line-height: normal; z-index: 0; font-family: &#39;Lucida Grande&#39;, &#39;Lucida Sans Unicode&#39;, Verdana, Arial, Helvetica, sans-serif; font-size: 12px;&#34;</span><span class="nt">&gt;&lt;/div&gt;</span>  
    <span class="nt">&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</span>  
    <span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">&#34;text/javascript&#34;</span><span class="nt">&gt;</span>  
            var chart1 = new Highcharts.Chart({  
                chart: {  
                    renderTo: &#39;custom_report&#39;,  
                    type: &#39;column&#39;  
                },  
                title: {  
                    text: null  
                },  
                xAxis: {  
                    categories: $[categories],  
                    title: {  
                        text: null  
                    },  
                    labels: {  
                        rotation: -45  
                    }  
                },  
                yAxis: {  
                    min: 0,  
                    title: {  
                        text: null  
                    }  
                },  
                series: $[series]  
            });  
    <span class="nt">&lt;/script&gt;</span>  
<span class="nt">&lt;/j:jelly&gt;</span></code></pre></div>
      </div>

      <a class="u-url" href="/blog/how-to-build-custom-charts-and-reports" hidden></a>
    </article><div class="subscribe-form">
  
  <div id="mc_embed_signup">
    <form action="https://codecreative.us14.list-manage.com/subscribe/post?u=98c1070493fa133df8ea08394&amp;id=f759c17295" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
      <div id="mc_embed_signup_scroll">
        <h2>Subscribe</h2>
        <div class="subtext">Sign up with your email address to receive news and updates.</div>
        <div>
          <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="Email Address" required>

          
          <div class="sr-only" aria-hidden="true">
            <input type="text" name="b_98c1070493fa133df8ea08394_f759c17295" tabindex="-1" value="">
          </div>

          <input type="submit" value="Sign Up" name="subscribe" id="mc-embedded-subscribe" class="button">
        </div>
      </div>
    </form>
  </div>
  
</div>
</div>

      </main><footer>
  <div class="footer-content-wrap">
    <p class="text-align-center">
      <a href="/servicenow">Blog</a>
      &nbsp;|&nbsp;
      <a href="/about">About</a>
      &nbsp;|&nbsp;
      <a href="/contact">Contact</a>
    </p>
    <div class="text-align-center">
      
    </div>
  </div>
</footer>
<script type="text/javascript" src="/assets/main.js"></script>
</body>
</html>
