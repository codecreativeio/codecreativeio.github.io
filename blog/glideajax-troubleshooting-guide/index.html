<!DOCTYPE html>
<html>
  <head><meta charset="utf-8">

<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<link href="https://fonts.googleapis.com/css?family=Julius+Sans+One|Slabo+13px|Open+Sans:300" rel="stylesheet">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
<link rel="stylesheet" href="https://codecreative.io/assets/main.min.134f18f3e3a03f460e46afb7417c639309b72631f8a425376d406f35fac25eb1.css">
<title>GlideAjax Troubleshooting Guide | CodeCreative | A ServiceNow Blog</title>
<meta name="description" content="After my Demystifying GlideAjax infographic I always meant to go back and write a GlideAjax troubleshooting guide. The Community is still full of GlideAjax issues and questions, so hopefully this guide will help point folks in the right direction.">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?d=20181101201248">
<link rel="canonical" href="https://codecreative.io/blog/glideajax-troubleshooting-guide/"><meta property="og:site_name" content="CodeCreative | A ServiceNow Blog">
<meta property="og:title" content="GlideAjax Troubleshooting Guide">
<meta property="og:url" content="https://codecreative.io/blog/glideajax-troubleshooting-guide/">

<meta property="og:type" content="article">

<meta property="og:description" content="After my Demystifying GlideAjax infographic I always meant to go back and write a GlideAjax troubleshooting guide. The Community is still full of GlideAjax issues and questions, so hopefully this guide will help point folks in the right direction.">

<meta property="og:image" content="https://codecreative.io/blog/glideajax-troubleshooting-guide/images/social.png">

<meta itemprop="name" content="GlideAjax Troubleshooting Guide">
<meta itemprop="url" content="https://codecreative.io/blog/glideajax-troubleshooting-guide/">
<meta itemprop="description" content="After my Demystifying GlideAjax infographic I always meant to go back and write a GlideAjax troubleshooting guide. The Community is still full of GlideAjax issues and questions, so hopefully this guide will help point folks in the right direction.">

<meta itemprop="thumbnailUrl" content="https://codecreative.io/blog/glideajax-troubleshooting-guide/images/social.png">
<link rel="image_src" href="https://codecreative.io/blog/glideajax-troubleshooting-guide/images/social.png">
<meta itemprop="image" content="https://codecreative.io/blog/glideajax-troubleshooting-guide/images/social.png">


<meta name="twitter:title" content="GlideAjax Troubleshooting Guide">
<meta name="twitter:image" content="https://codecreative.io/blog/glideajax-troubleshooting-guide/images/social.png">
<meta name="twitter:url" content="https://codecreative.io/blog/glideajax-troubleshooting-guide/">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:description" content="After my Demystifying GlideAjax infographic I always meant to go back and write a GlideAjax troubleshooting guide. The Community is still full of GlideAjax issues and questions, so hopefully this guide will help point folks in the right direction.">

<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-90280965-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-90280965-1');
</script>

<script type="application/ld+json">
{
    "@context" : "http://schema.org",
    "@type" : "BlogPosting",
    "mainEntityOfPage": {
         "@type": "WebPage",
         "@id": "https://codecreative.io/"
    },
    "name" : "GlideAjax Troubleshooting Guide",
    "headline" : "GlideAjax Troubleshooting Guide",
    "description" : "After my Demystifying GlideAjax infographic I always meant to go back and write a GlideAjax troubleshooting guide. The Community is still full of GlideAjax issues and questions, so hopefully this guide will help point folks in the right direction.","image": "https://codecreative.io/blog/glideajax-troubleshooting-guide/images/social.png","inLanguage" : "en-US",
      "author" : "Travis Toulson",
      "creator" : "Travis Toulson","publisher": "Travis Toulson",
    "copyrightHolder" : "Travis Toulson",
    "copyrightYear" : "2017",
    "datePublished": "2017-03-02 17:00:00 &#43;0000 UTC",
    "dateModified" : "2017-03-02 17:00:00 &#43;0000 UTC",
    "url" : "https://codecreative.io/blog/glideajax-troubleshooting-guide/",
    "wordCount" : "1478",
    "keywords" : [ "Blog" ]
}
</script>


  </head>
  <body><header role="banner">
  <h1 class="logo">
      <a href="/">
         <img src="/assets/codecreativelogo.png" alt="GlideAjax Troubleshooting Guide" />
         <span class="sr-only">CodeCreative Logo, click to navigate home</span>
      </a>
    </h1>

  <div class="menuToggle">
    <button class="hamburger" type="button" onclick="toggleMenu()">
      <span class="hamburger-box">
        <span class="hamburger-inner"></span>
      </span>
      <span class="sr-only">Toggle Menu</span>
    </button>
  </div>

  <nav class="fullNav">
    <ul>
      
      
        <li title="Home">
          <a class="" href="/">Home</a>
        </li>
      
        <li title="Blog">
          <a class="" href="/blog/">Blog</a>
        </li>
      
        <li title="About">
          <a class="" href="/about/">About</a>
        </li>
      
        <li title="Contact">
          <a class="" href="/contact/">Contact</a>
        </li>
      
    </ul>
  </nav>
</header>
<main>
  <header class="banner">
    <h1>GlideAjax Troubleshooting Guide</h1>
  </header>

  <div class="content text-content">
    <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

      <header class="post-header">
        <h1 class="post-title p-name sr-only" itemprop="name headline">GlideAjax Troubleshooting Guide</h1>
        <p class="post-meta">
            <time class="dt-published" datetime="2017-03-02T17:00:00Z" itemprop="datePublished">
            March 02, 2017
            </time>
          
            
            â€¢ <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Travis Toulson</span></span>
          
        </p>
      </header>

      <div class="post-content e-content" itemprop="articleBody">
        

<p>After my <a href="/blog/demystifying-glideajax">Demystifying GlideAjax</a> infographic I always meant to go back and write a GlideAjax troubleshooting guide. Both troubleshooting my own scripts and helping folks on the ServiceNow Community, I run into the same mistakes over and over and over again. And in spite of making the same mistakes, and eventually stumbling across the same solutions, I&rsquo;ve (shamefully) never quite refined my troubleshooting process on this one. I&rsquo;m pretty sure if I forget sysparm_name in my Client Script again, ServiceNow is going to send people to my door to reclaim my ServiceNow certificates until I go through remediation training.</p>

<p>So to hopefully avoid any future &ldquo;<a href="https://www.youtube.com/watch?v=H2uHBhKTSe0">the files are in the computer</a>&rdquo; moments during my troubleshooting, here are some helpful tips on troubleshooting GlideAjax.</p>

<hr />

<h2 id="script-include">Script Include</h2>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">HelloWorld</span> <span class="o">=</span> <span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">();</span>
<span class="nx">HelloWorld</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">extendsObject</span><span class="p">(</span><span class="nx">AbstractAjaxProcessor</span><span class="p">,</span> <span class="p">{</span>
   <span class="nx">helloWorld</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="s2">&#34;Hello &#34;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">getParameter</span><span class="p">(</span><span class="s1">&#39;sysparm_user_name&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;!&#34;</span><span class="p">;</span>
   <span class="p">},</span>

   <span class="nx">_privateFunction</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="c1">// this function is not client callable     
</span><span class="c1"></span>
   <span class="p">}</span>

<span class="p">});</span>
</code></pre></div>
<h3 id="inherit-from-the-abstractajaxprocessor">Inherit from the AbstractAjaxProcessor</h3>

<p>Checkout Line 2 in the above Script Include. Notice that Object.extendsObject? That is absolutely vital to the Ajax script. The AbstractAjaxProcessor Script Include provides a standard set of functions that every GlideAjax Script Include must implement. The interface basically acts as a mediator that allows extracting data from the XML request and building the XML response that GlideAjax relies upon for messaging between client and server.</p>

<p>No AbstractAjaxProcessor, no XML messages, no GlideAjax. Make sure a line like this exists in your Script Include.</p>

<h3 id="do-not-use-an-initialize-function">Do not use an initialize function</h3>

<p>This may be less obvious, but do you notice that there is no initialize function in the Script Include example. This is actually extremely important. The AbstractAjaxProcessor has its own initialize function and creating this function on your inheriting Script Include overrides the base class initialize function. It has a similar result to not inheriting the AbstractAjaxProcessor at all.</p>

<p>Normally, when using class inheritance like this, you would explicitly call the base class function (in Prototype.js this is done with the $super parameter) but unless it has changed recently, I&rsquo;ve never been able to do this in ServiceNow.</p>

<p>That said, you can copy the initialize function from AbstractAjaxProcessor to your Script Include, but keep in mind that future changes to AbstractAjaxProcessor could break your Script Include in upgrades if you do this.</p>

<h3 id="mark-the-script-include-as-client-callable">Mark the Script Include as Client Callable</h3>

<figure>
  <img src="images/ServiceNow+Client+Callable+Script+Include.png" />
  <figcaption>
    Client Callable Script Include
  </figcaption>
</figure>

<p>Another possible point of failure for GlideAjax is failing to mark the Script Include as Client callable. If there is not a check in the Client callable checkbox, then GlideAjax doesn&rsquo;t know the Script Include exists. This checkbox is a security measure and prevents malicious users from being able to call any Script Include from the client using browser dev tools.</p>

<p>As a bonus, go ahead and check Client callable as your first step. When you follow up by tying in a Name, ServiceNow will automatically script a basic GlideAjax Script Include. This will take care of both the previously mentioned initialize function and AbstractAjaxProcessor issues.</p>

<h3 id="use-a-public-function">Use a Public Function</h3>

<p>GlideAjax can only use public functions from the client script. The distinguishing feature is the presence or absence of the underscore (_) at the front of the function name. Public functions will start with a letter, private functions will start with an underscore. So if your function name is _doSomethingCool, GlideAjax will not be able to use it. You will need to provide a public interface such as doSomethingCool. You can see this at work in the above Script Include between the helloWorld function and the _privateFunction function.</p>

<p>Personally, I like to structure my GlideAjax functions so that the legwork is done in a private function while the public function handles all the GlideAjax parameters and value returns. That way I can test my private functions using a background script without GlideAjax interfering.</p>

<h3 id="set-return-values">Set Return Values</h3>

<p>GlideAjax has two ways of setting the answer values in the message that gets returned to the client. The first way is to simply use a &ldquo;return&rdquo; statement as done in the helloWorld function above on line 4. This will set the &ldquo;answer&rdquo; parameter for the Client Script to consume.</p>

<p>The other approach is to use the this.newItem and the setAttribute function calls in order to set multiple answer values. You can see this approach at play in the below Script Include from the ServiceNow Wiki.</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="cm">/*
</span><span class="cm"> * MyFavoritesAjax script include Description - sample AJAX processor returning multiple value pairs
</span><span class="cm"> */</span>
<span class="kd">var</span> <span class="nx">MyFavoritesAjax</span> <span class="o">=</span> <span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">();</span>
<span class="nx">MyFavoritesAjax</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">extendsObject</span><span class="p">(</span><span class="nx">AbstractAjaxProcessor</span><span class="p">,</span> <span class="p">{</span>

    <span class="cm">/*
</span><span class="cm">     * method available to client scripts call using:
</span><span class="cm">     * var gajax = new GlideAjax(&#34;MyFavoritesAjax&#34;);
</span><span class="cm">     * gajax.addParam(&#34;sysparm_name&#34;, &#34;getFavorites&#34;);
</span><span class="cm">     */</span>
    <span class="nx">getFavorites</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// build new response xml element for result
</span><span class="c1"></span>        <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">newItem</span><span class="p">(</span><span class="s2">&#34;result&#34;</span><span class="p">);</span>

        <span class="nx">result</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&#34;message&#34;</span><span class="p">,</span> <span class="s2">&#34;returning all favorites&#34;</span><span class="p">);</span>

        <span class="c1">//add some favorite nodes with name and value attributes
</span><span class="c1"></span>        <span class="k">this</span><span class="p">.</span><span class="nx">_addFavorite</span><span class="p">(</span><span class="s2">&#34;color&#34;</span><span class="p">,</span> <span class="s2">&#34;blue&#34;</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_addFavorite</span><span class="p">(</span><span class="s2">&#34;beer&#34;</span><span class="p">,</span> <span class="s2">&#34;lager&#34;</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_addFavorite</span><span class="p">(</span><span class="s2">&#34;pet&#34;</span><span class="p">,</span> <span class="s2">&#34;dog&#34;</span><span class="p">);</span>

        <span class="c1">// all items are returned to the client through the inherited methods of AbstractAjaxProcessor
</span><span class="c1"></span>    <span class="p">},</span>

    <span class="nx">_addFavorite</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">favs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">newItem</span><span class="p">(</span><span class="s2">&#34;favorite&#34;</span><span class="p">);</span>
        <span class="nx">favs</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&#34;name&#34;</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span>
        <span class="nx">favs</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&#34;value&#34;</span><span class="p">,</span> <span class="nx">value</span><span class="p">);</span>
    <span class="p">},</span>

    <span class="nx">type</span> <span class="o">:</span> <span class="s2">&#34;MyFavoritesAjax&#34;</span>

<span class="p">});</span>
</code></pre></div>
<p>Either way, it is important to set a return value in your publicly accessed function. In most cases, the simple return value is all you need.</p>

<h3 id="mark-script-include-public-if-needed">Mark Script Include Public if Needed</h3>

<p>When accessing a GlideAjax Script Include from a public UI Page or Public CMS page, you also need to make your Script Include public. This is accomplished by setting the isPublic attribute on the Script Include object as shown below. This is another one of those security features to protect your Script Includes from malicious users. Without it, any user on the internet could use your GlideAjax script. In other words, be careful about which Script Includes you make public and test the security of those scripts and the tables that they access.</p>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">HelloWorld</span> <span class="o">=</span> <span class="nx">Class</span><span class="p">.</span><span class="nx">create</span><span class="p">();</span>
<span class="nx">HelloWorld</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">extendsObject</span><span class="p">(</span><span class="nx">AbstractAjaxProcessor</span><span class="p">,</span> <span class="p">{</span>
   <span class="nx">helloWorld</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="s2">&#34;Hello &#34;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">getParameter</span><span class="p">(</span><span class="s1">&#39;sysparm_user_name&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;!&#34;</span><span class="p">;</span>
   <span class="p">},</span>

   <span class="nx">_privateFunction</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="c1">// this function is not client callable     
</span><span class="c1"></span>
   <span class="p">},</span>

   <span class="nx">isPublic</span><span class="o">:</span> <span class="kc">true</span>

<span class="p">});</span>
</code></pre></div>
<hr />

<h2 id="client-script">Client Script</h2>
<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">ga</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GlideAjax</span><span class="p">(</span><span class="s1">&#39;HelloWorld&#39;</span><span class="p">);</span>
<span class="nx">ga</span><span class="p">.</span><span class="nx">addParam</span><span class="p">(</span><span class="s1">&#39;sysparm_name&#39;</span><span class="p">,</span><span class="s1">&#39;helloWorld&#39;</span><span class="p">);</span>
<span class="nx">ga</span><span class="p">.</span><span class="nx">addParam</span><span class="p">(</span><span class="s1">&#39;sysparm_user_name&#39;</span><span class="p">,</span><span class="s2">&#34;Bob&#34;</span><span class="p">);</span>
<span class="nx">ga</span><span class="p">.</span><span class="nx">getXML</span><span class="p">(</span><span class="nx">HelloWorldParse</span><span class="p">);</span>

<span class="kd">function</span> <span class="nx">HelloWorldParse</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
   <span class="kd">var</span> <span class="nx">answer</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">responseXML</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&#34;answer&#34;</span><span class="p">);</span>
   <span class="nx">alert</span><span class="p">(</span><span class="nx">answer</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="correct-script-include-name">Correct Script Include Name</h3>

<p>It&rsquo;s sad to say but make sure you use the correct Script Include name on the first line of your GlideAjax call in your Client Script. In line 1 above, you see &lsquo;HelloWorld&rsquo; in the first and only parameter to the GlideAjax constructor function. This is used by GlideAjax to find the correct Script Include server side so if you spell it wrong, you won&rsquo;t get your desired results.</p>

<h3 id="correct-function-name-as-sysparm-name">Correct Function Name as sysparm_name</h3>

<p>Likewise, you have to have something like line 2 in the above Client Script. That is, you need to add a parameter called sysparm_name which should map to the public function you want to call on the Script Include. In this case we are calling helloWorld on the Script Include. Traditionally, GlideAjax has been fairly silent when it fails to find the correct Script Include or function on that Script Include. It just assumes you meant to do that and keeps on going with an empty or undefined response. So double check the function call and spelling of the parameters passed, it can be as simple as that.</p>

<h3 id="remember-a-callback">Remember a Callback</h3>

<p>So you can do GlideAjax synchronously or asynchronously. Async GlideAjax is what you will want to use in most circumstances and to do that you have to pass a callback function. You can see this in the above Client Script in both the getXML function and the function named HelloWorldParse. When getXML retrieves the information from the server, HelloWorldParse will be called with the results. Notice the parameter &ldquo;response&rdquo; in the HelloWorldParse function. Don&rsquo;t forget that.</p>

<p>Without this callback, your server data gets dumped into the abyss after being retrieved.</p>

<h3 id="treat-result-as-a-primitive-data-type">Treat Result as a Primitive Data Type</h3>

<p>Lastly, remember to treat the &ldquo;answer&rdquo; as a primitive. In other words, on the line where you see response.responseXML.documentElement.getAttribute(&lsquo;answer&rsquo;), remember that the result of that function is not a complex object. You may have a GlideRecord server side, but in the Client Script you have a string, number, boolean, null, or undefined value.</p>

<p>That means there is no reason to do getAttribute(&lsquo;answer&rsquo;).doSomething(). There is no doSomething, it doesn&rsquo;t exist. The reason is the hidden XML message under the hood of GlideAjax. To communicate between the Client Script and Script Include, an XML message is used. Since XML doesn&rsquo;t understand GlideRecord or other complex objects, any value you pass will be converted to a primitive type.</p>

<hr />

<h2 id="last-troubleshooting-tip">Last Troubleshooting Tip</h2>

<p>Add logging statements to both your Client Script and Script Include. The messaging that occurs between them can make it difficult to determine where in the process the breakdown occurs. Following a trace of logging statements can reveal where the process stops which may help identify the cause.</p>

<p>Got other troubleshooting tips for GlideAjax? Let me know, I&rsquo;d love to include them!</p>

      </div>

      <a class="u-url" href="/blog/glideajax-troubleshooting-guide" hidden></a>
    </article><div class="subscribe-form">
  
  <div id="mc_embed_signup">
    <form action="https://codecreative.us14.list-manage.com/subscribe/post?u=98c1070493fa133df8ea08394&amp;id=f759c17295" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
      <div id="mc_embed_signup_scroll">
        <h2>Subscribe</h2>
        <div class="subtext">Sign up with your email address to receive news and updates.</div>
        <div>
          <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="Email Address" required>

          
          <div class="sr-only" aria-hidden="true">
            <input type="text" name="b_98c1070493fa133df8ea08394_f759c17295" tabindex="-1" value="">
          </div>

          <input type="submit" value="Sign Up" name="subscribe" id="mc-embedded-subscribe" class="button">
        </div>
      </div>
    </form>
  </div>
  
</div>
</div>

      </main><footer>
  <div class="footer-content-wrap">
    <p class="text-align-center">
      <a href="/servicenow">Blog</a>
      &nbsp;|&nbsp;
      <a href="/about">About</a>
      &nbsp;|&nbsp;
      <a href="/contact">Contact</a>
    </p>
    <div class="text-align-center">
      
    </div>
  </div>
</footer>
<script type="text/javascript" src="/assets/main.js"></script>
</body>
</html>
